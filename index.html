<!DOCTYPE html>
<html>
  <head>
    <link href="slate-master/dist/css/slate.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
      $(function() {
        //------------ON PAGE LOAD-------------
        $("#toPresets").hide();
        $("#subjectPresets").hide();
        $("#bodyPresets").hide();
        var rs = JSON.parse(localStorage.getItem(1));
        
        if (rs.gmail.address !== null) {
          $("#gmail_addr").val(rs.gmail.address);
          $("#gmail_pass").val(rs.gmail.password);
          $("#to1").val(rs.to.to_1);
          $("#to2").val(rs.to.to_2);
          $("#to3").val(rs.to.to_3);
          $("#to4").val(rs.to.to_4);
          $("#to5").val(rs.to.to_5);
          $("#sub1").val(rs.subject.sub_1);
          $("#sub1").val(rs.subject.sub_1);
        }
        
        
        $("#toButton").click(function() {
          $("#toPresets").toggle(500);
        });
        $("#subjectButton").click(function() {
          $("#subjectPresets").toggle(500);
        });
        $("#bodyButton").click(function() {
          $("#bodyPresets").toggle(500);
        });
        //----------ON "SEND" CLICK----------------
        $("#submitButton").click(function() {
          var detailsArray = new Array();
          var gmailAddr = $("#gmail_addr").val();
          detailsArray[detailsArray.length] = gmailAddr;
          var gmailPass = $("#gmail_pass").val();
          detailsArray[detailsArray.length] = gmailPass;
          
          var to1 = $("#to1").val();
          detailsArray[detailsArray.length] = to1;
          var to2 = $("#to2").val();
          detailsArray[detailsArray.length] = to2;
          var to3 = $("#to3").val();
          detailsArray[detailsArray.length] = to3;
          var to4 = $("#to4").val();
          detailsArray[detailsArray.length] = to4;
          var to5 = $("#to5").val();
          detailsArray[detailsArray.length] = to5;
          
          var sub1 = $("#sub1").val();
          detailsArray[detailsArray.length] = sub1;
          var sub2 = $("#sub2").val();
          detailsArray[detailsArray.length] = sub2;
          var sub3 = $("#sub3").val();
          detailsArray[detailsArray.length] = sub3;
          
          var body1 = $("#body1").val();
          detailsArray[detailsArray.length] = body1;
          var body2 = $("#body2").val();
          detailsArray[detailsArray.length] = body2;
          var body3 = $("#body3").val();
          detailsArray[detailsArray.length] = body3;
          var body4 = $("#body4").val();
          detailsArray[detailsArray.length] = body4;
          var body5 = $("#body5").val();
          detailsArray[detailsArray.length] = body5;
          
          var settingsArr = new Array();
          
          for (var i = 0; i < detailsArray.length; i++) {
            if (detailsArray[i] === null || detailsArray[i] === undefined) {
              detailsArray[i] = "not set";
            } else if (detailsArray[i] === ""){
              detailsArray[i] = "not set";
            } else {
              detailsArray[i] = detailsArray[i]
            }
            
          }
          
          
          var options = { 
            gmail: { 
              address: detailsArray[0], 
              password: detailsArray[1] 
            },
            to: { 
              to_1: detailsArray[2], 
              to_2: detailsArray[3], 
              to_3: detailsArray[4], 
              to_4: detailsArray[5],
              to_5: detailsArray[6]
            },
            subject: {
              sub_1: detailsArray[7],
              sub_2: detailsArray[8],
              sub_3: detailsArray[9]
            }, 
            body: { 
              body_1: detailsArray[10],
              body_2: detailsArray[11],
              body_3: detailsArray[12],
              body_4: detailsArray[13],
              body_5: detailsArray[14]
            }
          }
          var optionsToSend = JSON.stringify(options);
          localStorage.setItem(1, optionsToSend);
          
          if ($.inArray('not set', detailsArray) != -1) {
             var x = confirm('There are some details not set - continue?');
             if (x !== true) {
               return;
             } else {
               document.location = "pebblejs://close#" + encodeURIComponent(optionsToSend);
              
             }
          } else {
            document.location = "pebblejs://close#" + encodeURIComponent(optionsToSend);
            
          }
          
          
        });
      });
      
    </script>
    <title>Mail for Pebble</title>
  </head>
  
  <body>
    <div class="item-container">
      <div class="item-container-header">Mail for Pebble</div>
      <div class="item-container-content">
        <div class="item">
          Hi.<br>
          Welcome to Mail for Pebble, the app allowing all Pebble users to send emails, directly from their watch. This app is currently only available for Gmail users.
          <br><strong>WARNING: THIS WEBSITE IS CURRENTLY BEING DEVELOPED - EXPECT STRANGE THINGS TO HAPPEN</strong>
          <br>Website update notes:
          <br> -Added system to prevent empty forms being submitted, causing the app to crash.
        </div>
      </div>
    </div>
    <div class="item-container">
      <div class="item-container-header">Gmail settings</div>
      <div class="item-container-content">
        <label class="item">
          Gmail address
          <div class="item-input-wrapper">
            <input type="text" class="item-input" name="gmail_addr" id="gmail_addr" placeholder="youraddress@gmail.com">
          </div>
        </label>
        <label class="item">
          Gmail password
          <div class="item-input-wrapper">
            <input type="password" class="item-input" name="gmail_pass" id="gmail_pass" placeholder="your_password">
          </div>
        </label>
      </div>
    </div>
    <div class="item-container">
      <div class="item-container-header">Email presets</div>
      <div class="item-container-content">
        <div class="item">
          To:<br>
          <button class="item-button" id="toButton">SHOW</button>
          <div id="toPresets">
            <div class="item-input-wrapper" id="toPreset1">
              <input type="text" class="item-input" id="to1" placeholder="reciever@theiremail.com">
            </div>
            <div class="item-input-wrapper" id="toPreset2">
              <input type="text" class="item-input" id="to2" placeholder="reciever@theiremail.com">
            </div>
            <div class="item-input-wrapper" id="toPreset3">
              <input type="text" class="item-input" id="to3" placeholder="reciever@theiremail.com">
            </div>
            <div class="item-input-wrapper" id="toPreset4">
              <input type="text" class="item-input" id="to4" placeholder="reciever@theiremail.com">
            </div>
            <div class="item-input-wrapper" id="toPreset5">
              <input type="text" class="item-input" id="to5" placeholder="reciever@theiremail.com">
            </div>
          </div>
        </div>
      
        <div class="item">
          Subject:<br>
          <button class="item-button" id="subjectButton">SHOW</button>
          <div id="subjectPresets">
           <div class="item-input-wrapper" id="subjectPreset1">
            <input type="text" class="item-input" id="sub1" placeholder="My subject">
           </div>
           <div class="item-input-wrapper" id="subjectPreset2">
            <input type="text" class="item-input" id="sub2" placeholder="My subject">
           </div>
           <div class="item-input-wrapper" id="subjectPreset3">
            <input type="text" class="item-input" id="sub3" placeholder="My subject">
           </div>
          </div>
        </div>
        
        <div class="item">
          Body:<br>
          <button class="item-button" id="bodyButton">SHOW</button>
          <div id="bodyPresets">
            <div class="item-input-wrapper" id="bodyPreset1">
              <input type="text" class="item-input" id="body1" placeholder="Hi, this is an email body!">
            </div>
            <div class="item-input-wrapper" id="bodyPreset2">
              <input type="text" class="item-input" id="body2" placeholder="Hi, this is an email body!">
            </div>
            <div class="item-input-wrapper" id="bodyPreset3">
              <input type="text" class="item-input" id="body3" placeholder="Hi, this is an email body!">
            </div>
            <div class="item-input-wrapper" id="bodyPreset4">
              <input type="text" class="item-input" id="body4" placeholder="Hi, this is an email body!">
            </div>
            <div class="item-input-wrapper" id="bodyPreset5">
              <input type="text" class="item-input" id="body5" placeholder="Hi, this is an email body!">
            </div>
          </div>
        </div>
      </div>
      <div class="item-container-footer">
        <div class="item">
          The current version allows for 5 email <b>to</b> addresses, 3 email <b>subjects</b> and 5 email <b>bodies</b>.
        </div>
      </div>
    </div>
    <div class="item-container">
      <div class="item-container-header">Information and support</div>
      <div class="item-container-content">
        <div class="item">
          Version 0.1 Beta<br>
          Configuration page uses Slate CSS library, available <a href="https://github.com/pebble/slate">here</a>.<br>
          For support, send an email to <a href="mailto:mlb406@gmail.com?subject=Mail for pebble">mlb406@gmail.com</a>.<br>
          Alternatively, you can tweet me <a href="https://twitter.com/intent/tweet?screen_name=mlb406">@mlb406</a>.
        </div>
      </div>
    </div>
    <br>
    <div class="item-container">
      <div class="item-container-header">Submit settings</div>
      <div class="item-container-content">
        <div class="item"><button class="item-button" id="submitButton">SUBMIT</button></div>
        <label class="item" id="resultsLabel">
          
        </label>
      </div>
    </div>
  </body>
</html>
